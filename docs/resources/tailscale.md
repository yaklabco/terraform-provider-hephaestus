---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "hephaestus_tailscale Resource - hephaestus"
subcategory: ""
description: |-
  Installs and configures Tailscale integration for the Kubernetes cluster.
  This resource provides:
  Tailscale Operator: Manages Tailscale proxies for annotated servicesK8s API Exposure: Exposes the Kubernetes API on your tailnet for remote kubectl accessSubnet Router: Optionally exposes pod and service CIDRs to your tailnetRemote Kubeconfig: Generates a kubeconfig using the Tailscale endpoint
  Prerequisites
  Create an OAuth client at https://login.tailscale.com/admin/settings/oauthRequired scopes: devices:core (write), auth_keys (write)Configure ACL tags in your Tailscale policy
  Example Usage
  
  resource "hephaestus_tailscale" "main" {
    cluster_id         = hephaestus_control_plane.primary.id
    control_plane_ip   = hephaestus_control_plane.primary.node_ip
    oauth_client_id    = var.tailscale_oauth_client_id
    oauth_client_secret = var.tailscale_oauth_client_secret
    
    # Expose K8s API on tailnet
    expose_api_server    = true
    api_server_hostname  = "hephaestus-k8s-api"
    
    # Optional: Subnet router for full cluster access
    enable_subnet_router = false
    subnet_routes        = ["10.244.0.0/16", "10.96.0.0/12"]
    
    depends_on = [hephaestus_addon.cilium]
  }
  
  output "tailscale_kubeconfig" {
    value     = hephaestus_tailscale.main.tailscale_kubeconfig
    sensitive = true
  }
---

# hephaestus_tailscale (Resource)

Installs and configures Tailscale integration for the Kubernetes cluster.

This resource provides:
- **Tailscale Operator**: Manages Tailscale proxies for annotated services
- **K8s API Exposure**: Exposes the Kubernetes API on your tailnet for remote kubectl access
- **Subnet Router**: Optionally exposes pod and service CIDRs to your tailnet
- **Remote Kubeconfig**: Generates a kubeconfig using the Tailscale endpoint

## Prerequisites

1. Create an OAuth client at https://login.tailscale.com/admin/settings/oauth
2. Required scopes: devices:core (write), auth_keys (write)
3. Configure ACL tags in your Tailscale policy

## Example Usage

```hcl
resource "hephaestus_tailscale" "main" {
  cluster_id         = hephaestus_control_plane.primary.id
  control_plane_ip   = hephaestus_control_plane.primary.node_ip
  oauth_client_id    = var.tailscale_oauth_client_id
  oauth_client_secret = var.tailscale_oauth_client_secret
  
  # Expose K8s API on tailnet
  expose_api_server    = true
  api_server_hostname  = "hephaestus-k8s-api"
  
  # Optional: Subnet router for full cluster access
  enable_subnet_router = false
  subnet_routes        = ["10.244.0.0/16", "10.96.0.0/12"]
  
  depends_on = [hephaestus_addon.cilium]
}

output "tailscale_kubeconfig" {
  value     = hephaestus_tailscale.main.tailscale_kubeconfig
  sensitive = true
}
```



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cluster_id` (String) Cluster identifier from control_plane resource
- `control_plane_ip` (String) IP address of a control plane node for kubectl/helm operations
- `oauth_client_id` (String, Sensitive) Tailscale OAuth client ID
- `oauth_client_secret` (String, Sensitive) Tailscale OAuth client secret

### Optional

- `api_server_hostname` (String) Tailnet hostname for the Kubernetes API. Default: `hephaestus-k8s-api`
- `api_server_port` (Number) Port for the K8s API service. Default: 443
- `auth_key` (String, Sensitive) Tailscale auth key for subnet router (required if enable_subnet_router is true)
- `enable_subnet_router` (Boolean) Deploy a subnet router to expose cluster networks. Default: `false`
- `expose_api_server` (Boolean) Create a service to expose the Kubernetes API on your tailnet. Default: `true`
- `hostname_prefix` (String) Prefix for Tailscale hostnames. Default: `hephaestus-k8s`
- `namespace` (String) Kubernetes namespace for Tailscale components. Default: `tailscale`
- `subnet_routes` (List of String) CIDRs to advertise via subnet router. Default: ["10.244.0.0/16", "10.96.0.0/12"]
- `tags` (List of String) ACL tags to apply to Tailscale nodes (e.g., ["tag:k8s"])
- `version` (String) Tailscale operator Helm chart version

### Read-Only

- `api_server_tailscale_ip` (String) Tailscale IP address of the exposed Kubernetes API
- `id` (String) Resource identifier
- `installed_version` (String) Installed Tailscale operator version
- `status` (String) Current status of Tailscale integration
- `tailscale_kubeconfig` (String, Sensitive) Kubeconfig configured to use Tailscale endpoint for remote access
